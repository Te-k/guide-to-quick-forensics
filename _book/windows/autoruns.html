
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Review Programs Launching at Startup Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="processes.html" />
    
    
    <link rel="prev" href="../windows.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../preparations.html">
            
                <a href="../preparations.html">
            
                    
                    Preparations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../safety.html">
            
                <a href="../safety.html">
            
                    
                    Safety
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../trust.html">
            
                <a href="../trust.html">
            
                    
                    Trust
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../backup.html">
            
                <a href="../backup.html">
            
                    
                    Backup
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../methodology.html">
            
                <a href="../methodology.html">
            
                    
                    Methodology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../windows.html">
            
                <a href="../windows.html">
            
                    
                    Checking Windows Computers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.4.1" data-path="autoruns.html">
            
                <a href="autoruns.html">
            
                    
                    Review Programs Launching at Startup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="processes.html">
            
                <a href="processes.html">
            
                    
                    Review Running Processes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="network.html">
            
                <a href="network.html">
            
                    
                    Review Network Connections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="extract.html">
            
                <a href="extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../mac.html">
            
                <a href="../mac.html">
            
                    
                    Checking Mac Computers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../android.html">
            
                <a href="../android.html">
            
                    
                    Checking Android devices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    Checking iOS devices
            
                </span>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Review Programs Launching at Startup</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="review-programs-launching-at-startup">Review Programs Launching at Startup</h1>
<p>Spyware needs to find a way to run on start-up when a computer is rebooted, it is thus one of the first thing to check when looking for malicious programs. Windows systems have different ways to have programs running on startup, and spyware often use tricks to appears legitimate and/or avoiding standard autoruns methods.</p>
<p>The <a href="https://technet.microsoft.com/en-ca/sysinternals/bb963902.aspx" target="_blank">Sysinternals Autoruns</a> tool allows to list exhaustively the programs running on start-up (you should run this program as Administrator if possible) :</p>
<p><img src="../img/autoruns.png" alt="Autoruns"></p>
<p>Autoruns embedds a feature to check for binary files on <a href="https://www.virustotal.com/gui/home/upload" target="_blank">VirusTotal</a>, it is a very good way to do a first check on suspicious files (check the &quot;About Virus Total&quot; part after for more information). To enable check on VirusTotal, go in Options &gt; Scan Options and enable &quot;Check VirusTotal.com&quot; (be careful of not enabling &quot;Submit Unknown Files&quot;) :</p>
<p><img src="../img/autoruns2.png" alt="Autoruns"></p>
<p>Then Autoruns will take a bit of time to check for all the files on startup and add results under the form <em>X/X</em> where the first X is the number of antiviruses detecting this file as malicious and the second X is the total number of antiviruses checked.</p>
<p><img src="../img/autoruns3.png" alt="Autoruns"></p>
<p>Use this analysis to look more closely to :</p>
<ul>
<li>Any file detected as Malicious by at least one antivirus</li>
<li>Any file unknown by VirusTotal</li>
</ul>
<p>Then look for suspicious entries manually in tabs <code>Logon</code>, <code>Scheduled Tasks</code>, <code>Services</code>.</p>
<p>For each of these entries, you should look for :</p>
<ul>
<li><strong>The name of the entry :</strong> a random string would be suspicious, or any common name with typo (crhome)</li>
<li><strong>The description :</strong> most legitimate programs have a description</li>
<li><strong>The path :</strong> any program installed in C:\Users is suspicious (often in C:\Users\USERNAME\AppData), C:\Temp is clearly abnormal, most of the programs should be in C:\Program Files or C:\Program Files (x86)</li>
</ul>
<p>Common tricks :</p>
<ul>
<li>Many spyware will use the Windows program <code>rundll32.exe</code> to load the actual malicious file (often a dll file but that can be named otherwise). As rundll32 will be checked on VirusTotal it will avoid the detection</li>
</ul>
<p>Example of suspicious entries :</p>
<ul>
<li>The KeyBoy spyware creates a Registry Key in <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\shell</code> with the value <code>explorer.exe,C:\Windows\system32\rundll32.exe &quot;%LOCALAPPDATA%\cfs.dal&quot; cfsUpdate</code></li>
</ul>
<h2 id="about-virustotal">About VirusTotal</h2>
<p><a href="https://www.virustotal.com/gui/home/upload" target="_blank">VirusTotal</a> (often called VT) is originally a Spanish company acquired by Google in 2012. Its business model is to provide checking of files by many anviruses for free to everyone, and sell access to this data to security companies. So keep in mind that files uploaded to VirusTotal are <em>not kept confidential</em>.</p>
<p>There are two ways to check for a file in VirusTotal :</p>
<ul>
<li>Check if the fingerprint is known by VirusTotal : this is what is done by default by Sysinternals tools, it means that the file itself is not sent to VirusTotal, but it only check if the file is already known by VT. All Windows system files should be known, an unknown file on startup is definitely suspicious</li>
<li>Upload the file to VirusTotal : in that case the file is sent ot VirusTotal which analyze it using multiple antiviruses. Keep in mind that VirusTotal will share this file with its customers, so do not upload any sensitive information.</li>
</ul>
<p>Regarding results :</p>
<ul>
<li>A file having more than 5 antiviruses detecting it as malicious definitely indicate a spyware. You can check for the name of the spyware given by antiviruses or comment to have an idea of what kind of spyware it can be.</li>
<li>A file with less then 5 antiviruses can be either a malicious file detected y few antiviruses, or a legitimate file with false positive detection</li>
<li>A file known by VT without any</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../windows.html" class="navigation navigation-prev " aria-label="Previous page: Checking Windows Computers">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="processes.html" class="navigation navigation-next " aria-label="Next page: Review Running Processes">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Review Programs Launching at Startup","level":"1.4.1","depth":2,"next":{"title":"Review Running Processes","level":"1.4.2","depth":2,"path":"windows/processes.md","ref":"windows/processes.md","articles":[]},"previous":{"title":"Checking Windows Computers","level":"1.4","depth":1,"path":"windows.md","ref":"windows.md","articles":[{"title":"Review Programs Launching at Startup","level":"1.4.1","depth":2,"path":"windows/autoruns.md","ref":"windows/autoruns.md","articles":[]},{"title":"Review Running Processes","level":"1.4.2","depth":2,"path":"windows/processes.md","ref":"windows/processes.md","articles":[]},{"title":"Review Network Connections","level":"1.4.3","depth":2,"path":"windows/network.md","ref":"windows/network.md","articles":[]},{"title":"Extract Data for Further Analysis","level":"1.4.4","depth":2,"path":"windows/extract.md","ref":"windows/extract.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"windows/autoruns.md","mtime":"2019-07-25T10:45:22.904Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-07-25T10:49:31.599Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

